<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Websocket Tutorial 03</title>
</head>
<body>
	<textarea id="messagesTextArea" cols="50" rows="10"></textarea>
	<br />
	<input type="text" id="message" size="50" />
	<input type="button" onClick="sendMessage()" value="Send" />
</body>
<script type="text/javascript">
	var webSocket = new WebSocket(
			'ws://localhost:8080/WebSocketPractice/chatServerEndpoint');
	webSocket.onmessage = function processMessage(chatMessage) {
		var jsonData = JSON.parse(chatMessage.data);
		document.getElementById('messagesTextArea').value += jsonData.name
				+ ': ' + jsonData.message + '\n';
		
		// if (jsonData.message != null) {
		//		messagesTextArea.value += jsonData.message + "\n";
		// }
	}
	
	function sendMessage() {
		var message = document.getElementById('message');
		webSocket.send(JSON.stringify({'message' : message.value}));
		message.value = "";
	}
	window.onbeforeunload = function() {
		webSocket.onclose = function() {};
		webSocket.close()
	};
</script>
</html>